{"version":3,"sources":["src/app/tab3/tab3.page.html","src/app/tab3/phaser/CratePool.ts","src/app/tab3/phaser/CrateScene.ts","src/app/tab3/tab3.module.ts","src/app/tab3/tab3.page.scss","src/app/tab3/tab3.page.ts"],"names":[],"mappings":";;;;;;;;;;;;;AAAA,IAAA,mBAAA,CAAA,CAAA,CAAA,mBAAA;AAAe;;;AAAA,IAAA,mBAAA,CAAA,SAAA,CAAA,GAAA,6LAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACEf,UAAM,SAAS,GAAG,OAAlB;;AAEA,UAAM,KAAN,SAAoB,2CAAA,CAAA,CAAA,CAAO,OAAP,CAAe,MAAf,CAAsB,KAA1C,CAA+C;AAE9C,MAAA,WAAA,CAAY,KAAZ,EAAiC,CAAjC,EAA4C,CAA5C,EAAuD,GAAvD,EAAkE;AAEjE;AACA,cAAM,KAAK,CAAC,MAAN,CAAa,KAAnB,EAA0B,CAA1B,EAA6B,CAA7B,EAAgC,GAAhC;AACA;;AAN6C;;AAShC,UAAM,SAAN,SAAwB,2CAAA,CAAA,CAAA,CAAO,WAAP,CAAmB,KAA3C,CAAgD;AAE9D,MAAA,WAAA,CAAY,KAAZ,EAAiC,MAAA,GAAqD,EAAtF,EAAwF;AAEvF,cAAM,QAAQ,GAA+C;AAC5D,UAAA,SAAS,EAAE,KADiD;AAE5D,UAAA,OAAO,EAAE,CAAC;AAFkD,SAA7D;AAKA,cAAM,KAAN,EAAa,MAAM,CAAC,MAAP,CAAc,QAAd,EAAwB,MAAxB,CAAb;AACA;;AAED,MAAA,kBAAkB,CAAC,IAAD,EAAa;AAE9B,YAAI,KAAK,SAAL,KAAmB,CAAnB,IAAwB,IAAI,IAAI,CAApC,EACA;AACC;AACA;;AAED,aAAK,cAAL,CAAoB;AACnB,UAAA,GAAG,EAAE,SADc;AAEnB,UAAA,QAAQ,EAAE,IAFS;AAGnB,UAAA,OAAO,EAAE,KAHU;AAInB,UAAA,MAAM,EAAE;AAJW,SAApB;AAMA;;AAED,MAAA,KAAK,CAAC,CAAC,GAAG,CAAL,EAAQ,CAAC,GAAG,CAAZ,EAAe,GAAA,GAAc,SAA7B,EAAsC;AAE1C,cAAM,aAAa,GAAG,KAAK,WAAL,CAAiB,KAAjB,IAA0B,CAAhD;AAEA,cAAM,KAAK,GAAG,MAAM,GAAN,CAAU,CAAV,EAAa,CAAb,EAAgB,GAAhB,CAAd;;AAEA,YAAI,CAAC,KAAL,EACA;AACC;AACA;;AAED,YAAI,aAAJ,EACA;AACC,UAAA,KAAK,CAAC,SAAN,CAAgB,IAAhB;AACA,UAAA,KAAK,CAAC,UAAN,CAAiB,IAAjB;AACA,UAAA,KAAK,CAAC,KAAN,CAAY,GAAZ,CAAgB,KAAK,CAAC,IAAtB;AACA;;AAED,eAAO,KAAP;AACA;;AAED,MAAA,OAAO,CAAC,KAAD,EAAa;AAEnB,QAAA,KAAK,CAAC,SAAN,CAAgB,KAAhB;AACA,QAAA,KAAK,CAAC,UAAN,CAAiB,KAAjB;AACA,QAAA,KAAK,CAAC,iBAAN;AACA,QAAA,KAAK,CAAC,KAAN,CAAY,MAAZ,CAAmB,KAAK,CAAC,IAAzB;AACA;;AAtD6D;;AAyD/D,IAAA,2CAAA,CAAA,CAAA,CAAO,WAAP,CAAmB,iBAAnB,CAAqC,QAArC,CAA8C,WAA9C,EAA2D,YAAA;AAC1D;AACA,aAAO,KAAK,UAAL,CAAgB,GAAhB,CAAoB,IAAI,SAAJ,CAAc,KAAK,KAAnB,CAApB,CAAP;AACA,KAHD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClEA,UAAM,WAAW,mDAAjB;;AAKe,UAAM,WAAN,SAA0B,2CAAA,CAAA,CAAA,CAAO,KAAjC,CAAsC;AAKpD,MAAA,WAAA,GAAA;AAEC,cAAM,sBAAN;AACA;;AAED,MAAA,OAAO,GAAA;AAEN,aAAK,IAAL,CAAU,KAAV,CAAgB,uCAAA,CAAA,WAAA,CAAhB,EAA2B,kBAA3B;AACG;;AAED,MAAA,MAAM,GAAA;AAER,aAAK,MAAL,CAAY,KAAZ,CAAkB,SAAlB,CAA4B,CAA5B,EAA+B,CAAC,GAAhC,EAAqC,KAAK,KAAL,CAAW,KAAhD,EAAuD,KAAK,KAAL,CAAW,MAAX,GAAoB,GAA3E;AAEA,aAAK,KAAL,GAAa,KAAK,GAAL,CAAS,SAAT,EAAb;AAEA,aAAK,IAAL,CAAU,QAAV,CAAmB;AAClB,UAAA,KAAK,EAAE,GADW;AAElB,UAAA,IAAI,EAAE,IAFY;AAGlB,UAAA,QAAQ,EAAE,MAAK;AACd,iBAAK,UAAL;AACA;AALiB,SAAnB;AAQA,aAAK,QAAL,GAAgB,KAAK,GAAL,CAAS,IAAT,CAAc,EAAd,EAAkB,EAAlB,EAAsB,EAAtB,CAAhB;AACA,aAAK,QAAL,CAAc,QAAd,CAAuB,IAAvB;AACA;;AAED,MAAA,MAAM,GAAA;AAEL,YAAI,CAAC,KAAK,KAAN,IAAe,CAAC,KAAK,QAAzB,EACA;AACC;AACA;;AAED,cAAM,IAAI,GAAG,KAAK,KAAL,CAAW,SAAX,EAAb;AACA,cAAM,IAAI,GAAG,KAAK,KAAL,CAAW,YAAX,EAAb;AACA,cAAM,IAAI,GAAG,2CAAA,CAAA,CAAA,CAAO,KAAP,CAAa,MAAb,CAAoB,MAApB,CACZ,WADY,EAEZ,CACC,IADD,EAEC,IAFD,EAGC,IAAI,GAAG,IAHR,CAFY,CAAb;AASA,aAAK,QAAL,CAAc,OAAd,CAAsB,IAAtB;AACA;;AAEO,MAAA,UAAU,GAAA;AAEjB,YAAI,CAAC,KAAK,KAAV,EACA;AACC;AACA;;AAED,YAAI,KAAK,KAAL,CAAW,WAAX,CAAuB,IAAvB,KAAgC,EAApC,EACA;AACC;AACA;;AAED,cAAM,GAAG,GAAG,KAAK,QAAL,CAAc,GAAd,CAAkB,uCAAA,CAAA,WAAA,CAAlB,CAAZ;AACA,cAAM,SAAS,GAAG,GAAG,CAAC,cAAJ,GAAqB,KAArB,GAA6B,GAA/C;AACA,cAAM,CAAC,GAAG,2CAAA,CAAA,CAAA,CAAO,IAAP,CAAY,OAAZ,CAAoB,SAApB,EAA+B,KAAK,KAAL,CAAW,KAAX,GAAmB,SAAlD,CAAV;AAEA,cAAM,KAAK,GAAG,KAAK,KAAL,CAAW,KAAX,CAAiB,CAAjB,EAAoB,CAApB,CAAd;;AAEA,YAAI,CAAC,KAAL,EACA;AACC;AACA;;AAED,QAAA,KAAK,CAAC,cAAN,GACE,EADF,CACK,2CAAA,CAAA,CAAA,CAAO,KAAP,CAAa,MAAb,CAAoB,qBADzB,EACgD,OAAO,IAAG;AAExD,eAAK,KAAL,CAAY,OAAZ,CAAoB,KAApB;AACA,SAJF;AAMA,eAAO,KAAP;AACA;;AApFmD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACOrD,QAAa,cAAc,GAA3B,MAAa,cAAb,CAA2B,EAA3B;AAAa,IAAA,cAAc,GAAA,kCAAA,CAAA,YAAA,CAAA,CAAA,CAT1B,MAAA,CAAA,0CAAA,CAAA,UAAA,CAAA,CAAA,CAAS;AACR,MAAA,OAAO,EAAE,CACP,2CAAA,CAAA,aAAA,CADO,EAEP,4CAAA,CAAA,cAAA,CAFO,EAGP,2CAAA,CAAA,aAAA,CAHO,EAIP,4CAAA,CAAA,cAAA,CAAA,CAAa,QAAb,CAAsB,CAAC;AAAE,QAAA,IAAI,EAAE,EAAR;AAAY,QAAA,SAAS,EAAE,uCAAA,CAAA,UAAA;AAAvB,OAAD,CAAtB,CAJO,CADD;AAOR,MAAA,YAAY,EAAE,CAAC,uCAAA,CAAA,UAAA,CAAD;AAPN,KAAT,CAS0B,CAAA,EAAd,cAAc,CAAd;;;;;;;;;;;;;;;;AChBb,IAAA,mBAAA,CAAA,CAAA,CAAA,mBAAA;AAAe;;;AAAA,IAAA,mBAAA,CAAA,SAAA,CAAA,GAAA,iLAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;4CCGf;;;AAQA,QAAa,QAAQ,GAArB,MAAa,QAAb,CAAqB;AAIpB,MAAA,WAAA,GAAA,CAEC;;AAED,MAAA,gBAAgB,GAAA;AAEf,cAAM,MAAM,GAAiC;AAC5C,UAAA,MAAM,EAAE,oBADoC;AAE5C,UAAA,IAAI,EAAE,2CAAA,CAAA,CAAA,CAAO,IAF+B;AAG5C,UAAA,KAAK,EAAE,MAHqC;AAI5C,UAAA,MAAM,EAAE,MAJoC;AAK5C,UAAA,OAAO,EAAE;AACR,YAAA,OAAO,EAAE,QADD;AAER,YAAA,MAAM,EAAE;AACP,cAAA,KAAK,EAAE;AADA;AAFA,WALmC;AAW5C,UAAA,KAAK,EAAE,+CAAA,CAAA,SAAA;AAXqC,SAA7C;AAcA,aAAK,IAAL,GAAY,IAAI,2CAAA,CAAA,CAAA,CAAO,IAAX,CAAgB,MAAhB,CAAZ;AACA;;AAED,MAAA,eAAe,GAAA;AAEd,aAAK,IAAL,CAAU,OAAV,CAAkB,IAAlB;AACA,aAAK,IAAL,GAAY,IAAZ;AACA;;AA/BmB,KAArB;AAAa,IAAA,QAAQ,GAAA,kCAAA,CAAA,YAAA,CAAA,CAAA,CALpB,MAAA,CAAA,0CAAA,CAAA,WAAA,CAAA,CAAA,CAAU;AACV,MAAA,QAAQ,EAAE,UADA;AAEV,MAAA,QAAA,EAAA,kCAAA,CAAA,iBAAA,CAAA,CAAA,mBAAA;AAAA;AAAA,2EAAA,CAAA,EAAA,OAFU;;;;AAAA,KAAV,CAKoB,E,yEAAA,CAAA,EAAR,QAAQ,CAAR","sourcesContent":["export default \"<ion-header>\\n\\t<ion-toolbar>\\n\\t\\t<ion-title>\\n\\t\\t\\tCrates\\n\\t\\t</ion-title>\\n\\t</ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n\\t<div id=\\\"phaser-container-3\\\"></div>\\n</ion-content>\\n\"","import Phaser from 'phaser'\n\nconst KEY_CRATE = 'crate'\n\nclass Crate extends Phaser.Physics.Matter.Image\n{\n\tconstructor(scene: Phaser.Scene, x: number, y: number, key: string)\n\t{\n\t\t// need a wrapper Class to properly set the Matter World\n\t\tsuper(scene.matter.world, x, y, key)\n\t}\n}\n\nexport default class CratePool extends Phaser.GameObjects.Group implements ICratePool\n{\n\tconstructor(scene: Phaser.Scene, config: Phaser.Types.GameObjects.Group.GroupConfig = {})\n\t{\n\t\tconst defaults: Phaser.Types.GameObjects.Group.GroupConfig = {\n\t\t\tclassType: Crate,\n\t\t\tmaxSize: -1\n\t\t}\n\n\t\tsuper(scene, Object.assign(defaults, config))\n\t}\n\n\tinitializeWithSize(size: number)\n\t{\n\t\tif (this.getLength() > 0 || size <= 0)\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\tthis.createMultiple({\n\t\t\tkey: KEY_CRATE,\n\t\t\tquantity: size,\n\t\t\tvisible: false,\n\t\t\tactive: false\n\t\t})\n\t}\n\n\tspawn(x = 0, y = 0, key: string = KEY_CRATE)\n\t{\n\t\tconst spawnExisting = this.countActive(false) > 0\n\n\t\tconst crate = super.get(x, y, key)\n\n\t\tif (!crate)\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\tif (spawnExisting)\n\t\t{\n\t\t\tcrate.setActive(true)\n\t\t\tcrate.setVisible(true)\n\t\t\tcrate.world.add(crate.body)\n\t\t}\n\n\t\treturn crate\n\t}\n\n\tdespawn(crate: Crate)\n\t{\n\t\tcrate.setActive(false)\n\t\tcrate.setVisible(false)\n\t\tcrate.removeInteractive()\n\t\tcrate.world.remove(crate.body)\n\t}\n}\n\nPhaser.GameObjects.GameObjectFactory.register('cratePool', function() {\n\t// @ts-ignore\n\treturn this.updateList.add(new CratePool(this.scene));\n})\n\nexport {\n\tKEY_CRATE\n}\n","import Phaser from 'phaser'\n\nimport { KEY_CRATE } from './CratePool'\n\nconst INFO_FORMAT =\n`Size:       %1\nSpawned:    %2\nDespawned:  %3`\n\nexport default class CratesScene extends Phaser.Scene\n{\n\tprivate group?: ICratePool\n\tprivate infoText?: Phaser.GameObjects.Text\n\n\tconstructor()\n\t{\n\t\tsuper('crates-scene-physics')\n\t}\n\n\tpreload()\n    {\n\t\tthis.load.image(KEY_CRATE, 'assets/crate.png')\n    }\n\n    create()\n    {\n\t\tthis.matter.world.setBounds(0, -100, this.scale.width, this.scale.height + 100)\n\n\t\tthis.group = this.add.cratePool()\n\n\t\tthis.time.addEvent({\n\t\t\tdelay: 500,\n\t\t\tloop: true,\n\t\t\tcallback: () => {\n\t\t\t\tthis.spawnCrate()\n\t\t\t}\n\t\t})\n\n\t\tthis.infoText = this.add.text(16, 16, '')\n\t\tthis.infoText.setDepth(1000)\n\t}\n\n\tupdate()\n\t{\n\t\tif (!this.group || !this.infoText)\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\tconst size = this.group.getLength()\n\t\tconst used = this.group.getTotalUsed()\n\t\tconst text = Phaser.Utils.String.Format(\n\t\t\tINFO_FORMAT,\n\t\t\t[\n\t\t\t\tsize,\n\t\t\t\tused,\n\t\t\t\tsize - used\n\t\t\t]\n\t\t)\n\n\t\tthis.infoText.setText(text)\n\t}\n\n\tprivate spawnCrate()\n\t{\n\t\tif (!this.group)\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\tif (this.group.countActive(true) >= 10)\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\tconst tex = this.textures.get(KEY_CRATE)\n\t\tconst halfWidth = tex.getSourceImage().width * 0.5\n\t\tconst x = Phaser.Math.Between(halfWidth, this.scale.width - halfWidth)\n\n\t\tconst crate = this.group.spawn(x, 0)\n\n\t\tif (!crate)\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\tcrate.setInteractive()\n\t\t\t.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP, pointer => {\n\n\t\t\t\tthis.group!.despawn(crate)\n\t\t\t})\n\n\t\treturn crate\n\t}\n}\n","import { IonicModule } from '@ionic/angular';\nimport { RouterModule } from '@angular/router';\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Tab3Page } from './tab3.page';\n\n@NgModule({\n  imports: [\n    IonicModule,\n    CommonModule,\n    FormsModule,\n    RouterModule.forChild([{ path: '', component: Tab3Page }])\n  ],\n  declarations: [Tab3Page]\n})\nexport class Tab3PageModule {}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3RhYjMvdGFiMy5wYWdlLnNjc3MifQ== */\"","import { Component } from '@angular/core'\n\nimport Phaser from 'phaser'\n// import HelloWorldScene from './phaser/HelloWorldScene'\nimport CrateScene from './phaser/CrateScene'\n\n@Component({\n\tselector: 'app-tab3',\n\ttemplateUrl: 'tab3.page.html',\n\tstyleUrls: ['tab3.page.scss']\n})\nexport class Tab3Page\n{\n\tprivate game: Phaser.Game\n\n\tconstructor()\n\t{\n\t}\n\n\tionViewWillEnter()\n\t{\n\t\tconst config: Phaser.Types.Core.GameConfig = {\n\t\t\tparent: 'phaser-container-3',\n\t\t\ttype: Phaser.AUTO,\n\t\t\twidth: '100%',\n\t\t\theight: '100%',\n\t\t\tphysics: {\n\t\t\t\tdefault: 'matter',\n\t\t\t\tmatter: {\n\t\t\t\t\tdebug: true\n\t\t\t\t}\n\t\t\t},\n\t\t\tscene: CrateScene\n\t\t}\n\n\t\tthis.game = new Phaser.Game(config)\n\t}\n\n\tionViewDidLeave()\n\t{\n\t\tthis.game.destroy(true)\n\t\tthis.game = null\n\t}\n}\n"],"sourceRoot":"webpack:///","file":"tab3-tab3-module-es5.js"}