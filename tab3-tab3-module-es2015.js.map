{"version":3,"sources":["./src/app/tab3/tab3.page.html","./src/app/tab3/phaser/CratePool.ts","./src/app/tab3/phaser/CrateScene.ts","./src/app/tab3/tab3.module.ts","./src/app/tab3/tab3.page.scss","./src/app/tab3/tab3.page.ts"],"names":[],"mappings":"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","file":"tab3-tab3-module-es2015.js","sourcesContent":["export default \"<ion-header>\\n\\t<ion-toolbar>\\n\\t\\t<ion-title>\\n\\t\\t\\tCrates\\n\\t\\t</ion-title>\\n\\t</ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n\\t<div id=\\\"phaser-container-3\\\"></div>\\n</ion-content>\\n\"","import Phaser from 'phaser'\n\nconst KEY_CRATE = 'crate'\n\nclass Crate extends Phaser.Physics.Matter.Image\n{\n\tconstructor(scene: Phaser.Scene, x: number, y: number, key: string)\n\t{\n\t\t// need a wrapper Class to properly set the Matter World\n\t\tsuper(scene.matter.world, x, y, key)\n\t}\n}\n\nexport default class CratePool extends Phaser.GameObjects.Group implements ICratePool\n{\n\tconstructor(scene: Phaser.Scene, config: Phaser.Types.GameObjects.Group.GroupConfig = {})\n\t{\n\t\tconst defaults: Phaser.Types.GameObjects.Group.GroupConfig = {\n\t\t\tclassType: Crate,\n\t\t\tmaxSize: -1\n\t\t}\n\n\t\tsuper(scene, Object.assign(defaults, config))\n\t}\n\n\tinitializeWithSize(size: number)\n\t{\n\t\tif (this.getLength() > 0 || size <= 0)\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\tthis.createMultiple({\n\t\t\tkey: KEY_CRATE,\n\t\t\tquantity: size,\n\t\t\tvisible: false,\n\t\t\tactive: false\n\t\t})\n\t}\n\n\tspawn(x = 0, y = 0, key: string = KEY_CRATE)\n\t{\n\t\tconst spawnExisting = this.countActive(false) > 0\n\n\t\tconst crate = super.get(x, y, key)\n\n\t\tif (!crate)\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\tif (spawnExisting)\n\t\t{\n\t\t\tcrate.setActive(true)\n\t\t\tcrate.setVisible(true)\n\t\t\tcrate.world.add(crate.body)\n\t\t}\n\n\t\treturn crate\n\t}\n\n\tdespawn(crate: Crate)\n\t{\n\t\tcrate.setActive(false)\n\t\tcrate.setVisible(false)\n\t\tcrate.removeInteractive()\n\t\tcrate.world.remove(crate.body)\n\t}\n}\n\nPhaser.GameObjects.GameObjectFactory.register('cratePool', function() {\n\t// @ts-ignore\n\treturn this.updateList.add(new CratePool(this.scene));\n})\n\nexport {\n\tKEY_CRATE\n}\n","import Phaser from 'phaser'\n\nimport { KEY_CRATE } from './CratePool'\n\nconst INFO_FORMAT =\n`Size:       %1\nSpawned:    %2\nDespawned:  %3`\n\nexport default class CratesScene extends Phaser.Scene\n{\n\tprivate group?: ICratePool\n\tprivate infoText?: Phaser.GameObjects.Text\n\n\tconstructor()\n\t{\n\t\tsuper('crates-scene-physics')\n\t}\n\n\tpreload()\n    {\n\t\tthis.load.image(KEY_CRATE, 'assets/crate.png')\n    }\n\n    create()\n    {\n\t\tthis.matter.world.setBounds(0, -100, this.scale.width, this.scale.height + 100)\n\n\t\tthis.group = this.add.cratePool()\n\n\t\tthis.time.addEvent({\n\t\t\tdelay: 500,\n\t\t\tloop: true,\n\t\t\tcallback: () => {\n\t\t\t\tthis.spawnCrate()\n\t\t\t}\n\t\t})\n\n\t\tthis.infoText = this.add.text(16, 16, '')\n\t\tthis.infoText.setDepth(1000)\n\t}\n\n\tupdate()\n\t{\n\t\tif (!this.group || !this.infoText)\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\tconst size = this.group.getLength()\n\t\tconst used = this.group.getTotalUsed()\n\t\tconst text = Phaser.Utils.String.Format(\n\t\t\tINFO_FORMAT,\n\t\t\t[\n\t\t\t\tsize,\n\t\t\t\tused,\n\t\t\t\tsize - used\n\t\t\t]\n\t\t)\n\n\t\tthis.infoText.setText(text)\n\t}\n\n\tprivate spawnCrate()\n\t{\n\t\tif (!this.group)\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\tif (this.group.countActive(true) >= 10)\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\tconst tex = this.textures.get(KEY_CRATE)\n\t\tconst halfWidth = tex.getSourceImage().width * 0.5\n\t\tconst x = Phaser.Math.Between(halfWidth, this.scale.width - halfWidth)\n\n\t\tconst crate = this.group.spawn(x, 0)\n\n\t\tif (!crate)\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\tcrate.setInteractive()\n\t\t\t.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP, pointer => {\n\n\t\t\t\tthis.group!.despawn(crate)\n\t\t\t})\n\n\t\treturn crate\n\t}\n}\n","import { IonicModule } from '@ionic/angular';\nimport { RouterModule } from '@angular/router';\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Tab3Page } from './tab3.page';\n\n@NgModule({\n  imports: [\n    IonicModule,\n    CommonModule,\n    FormsModule,\n    RouterModule.forChild([{ path: '', component: Tab3Page }])\n  ],\n  declarations: [Tab3Page]\n})\nexport class Tab3PageModule {}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3RhYjMvdGFiMy5wYWdlLnNjc3MifQ== */\"","import { Component } from '@angular/core'\n\nimport Phaser from 'phaser'\n// import HelloWorldScene from './phaser/HelloWorldScene'\nimport CrateScene from './phaser/CrateScene'\n\n@Component({\n\tselector: 'app-tab3',\n\ttemplateUrl: 'tab3.page.html',\n\tstyleUrls: ['tab3.page.scss']\n})\nexport class Tab3Page\n{\n\tprivate game: Phaser.Game\n\n\tconstructor()\n\t{\n\t}\n\n\tionViewWillEnter()\n\t{\n\t\tconst config: Phaser.Types.Core.GameConfig = {\n\t\t\tparent: 'phaser-container-3',\n\t\t\ttype: Phaser.AUTO,\n\t\t\twidth: '100%',\n\t\t\theight: '100%',\n\t\t\tphysics: {\n\t\t\t\tdefault: 'matter',\n\t\t\t\tmatter: {\n\t\t\t\t\tdebug: true\n\t\t\t\t}\n\t\t\t},\n\t\t\tscene: CrateScene\n\t\t}\n\n\t\tthis.game = new Phaser.Game(config)\n\t}\n\n\tionViewDidLeave()\n\t{\n\t\tthis.game.destroy(true)\n\t\tthis.game = null\n\t}\n}\n"],"sourceRoot":"webpack:///"}